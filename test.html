<!DOCTYPE html>
<style>
.container {
    -webkit-perspective: 400px;
    perspective: 400px;
    position: absolute;
    top: 10px;
}
.box {
    display: inline-block;
    width: 100px;
    height: 100px;
    margin: 16px;
    border-style: solid;
    white-space: pre;
}
.test {
    border-color: green;
}
.expectation {
    color: red;
}
</style>
<div id="expectationContainer" class="container"></div>
<div id="testContainer" class="container"></div>
<script src="web-animations.js"></script>
<script>
'use strict';
var testGroups = [
  [
    'matrix3d(1,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,1)',
    'matrix(0.7, 0.7, -0.7, 0.7, 10, 20)',
    'matrix3d(0,0,-1,0, 0,1,0,0, 1,0,0,0, 0,0,0,1)',
  ], [
    'skew(20deg, 30deg)',
    'skewX(40deg)',
    'skewY(30deg)',
  ], [
    'scale(1.1, 1.2)',
    'scaleX(1.2)',
    'scaleY(1.1)',
    'scaleZ(2) translateZ(4px)',
  ], [
    'rotate(60deg)',
    'rotateX(70deg)',
    'rotateY(80deg)',
    'rotateZ(70deg)',
    'rotate3d(1, 1, 1, 60deg)',
  ], [
    'translate(10px, 20px)',
    'translateX(10px)',
    'translateY(20px)',
    'translateZ(30px)',
    'translate3d(10px, 20px, 40px)',
  ], [
    'translate(100px)',
    'translate(100px) rotate(20deg)',
    'translate(100px) rotate(20deg) scale(0.5)',
  ]
];

var animations = [];
var style = document.createElement('style');
var count = 0;

function addAnimationTest(from, to) {
  var testElement = document.createElement('div');
  testElement.classList.add('box', 'test');
  testContainer.appendChild(testElement);
  testElement.textContent = from + '\n' + to;
  animations.push(new Animation(testElement, [
      {transform: from},
      {transform: to},
    ], {
      duration: 1,
      easing: 'ease-in-out',
      direction: 'alternate',
      iterations: Infinity,
    }));

  var expectationElement = document.createElement('div');
  expectationElement.classList.add('box', 'expectation');
  expectationElement.textContent = from + '\n' + to;
  expectationElement.style.webkitAnimation = expectationElement.style.animation = 'expectation' + count + ' 1s alternate infinite ease-in-out';
  expectationContainer.appendChild(expectationElement);
  var keyframes = ' expectation' + count + '{' +
      'from{-webkit-transform:' + from + ';transform:' + from +';}' +
      'to{-webkit-transform:' + to + ';transform:' + to +';}}\n';
  style.textContent += '@-webkit-keyframes' + keyframes + '@keyframes' + keyframes;
  count++;
}

function addBreak() {
  testContainer.appendChild(document.createElement('hr'));
  expectationContainer.appendChild(document.createElement('hr'));
}

function addTestGroup(tests) {
  tests.forEach(function(transform) {
    addAnimationTest('none', transform);
  });
  tests.forEach(function(transform, i) {
    addAnimationTest(transform, tests[(i + 1) % tests.length]);
  });
  addBreak();
}

testGroups.forEach(addTestGroup);

expectationContainer.appendChild(style);
animations.forEach(function(animation) {document.timeline.play(animation);});
</script>